<template>
  <div style="display: flex" class="Sidebar">
    <div class="toolsBar items-center content-center" style="z-index: 10">
      <button class="myButton" @click="isFile = 2">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" version="1.1"
             width="20" height="20" viewBox="0 0 20 20">
          <g clip-path="url(#master_svg0_71_480)">
            <g>
              <g>
                <path
                    d="M14.3561,4.442622900390624L19.3345,4.442622900390624C19.702,4.442622900390624,20.0001,4.144642900390625,20.0001,3.777032900390625C20.0001,3.409432900390625,19.7021,3.111452900390625,19.3345,3.111452900390625L15.0217,3.111452900390625L15.0217,1.953402900390625L19.3345,1.953402900390625C19.702,1.953402900390625,20.0001,1.655422900390625,20.0001,1.287811900390625C20.0001,0.920202900390625,19.7021,0.622222900390625,19.3345,0.622222900390625L14.3561,0.622222900390625C13.9886,0.622222900390625,13.6905,0.920202900390625,13.6905,1.287811900390625L13.6905,1.866872900390625L9.37771,1.866872900390625C9.01017,1.866872900390625,8.71212,2.164852900390625,8.71212,2.532462900390625L8.71212,4.356092900390625L4.39933,4.356092900390625C4.03179,4.356092900390625,3.73374,4.654072900390625,3.73374,5.021682900390625L3.73374,9.334482900390626L0.665589,9.334482900390626C0.29798,9.334412900390625,0,9.632462900390625,0,10.000002900390625C0,10.367542900390625,0.29798,10.665622900390625,0.665589,10.665622900390625L3.7338,10.665622900390625L3.7338,14.978422900390624C3.7338,15.345922900390624,4.03178,15.644022900390626,4.39939,15.644022900390626L8.71226,15.644022900390626L8.71226,17.467622900390626C8.71226,17.835122900390626,9.01024,18.133222900390624,9.37784,18.133222900390624L13.6906,18.133222900390624L13.6906,18.712222900390625C13.6906,19.079822900390624,13.9886,19.377822900390626,14.3562,19.377822900390626L19.3346,19.377822900390626C19.7022,19.377822900390626,20.0002,19.079822900390624,20.0002,18.712222900390625C20.0002,18.344622900390625,19.7022,18.046622900390624,19.3346,18.046622900390624L15.0218,18.046622900390624L15.0218,16.888522900390626L19.3346,16.888522900390626C19.7022,16.888522900390626,20.0002,16.590622900390628,20.0002,16.222922900390625C20.0002,15.855322900390625,19.7022,15.557422900390625,19.3346,15.557422900390625L14.3562,15.557422900390625C13.9887,15.557422900390625,13.6906,15.855322900390625,13.6906,16.222922900390625L13.6906,16.802022900390625L10.0434,16.802022900390625L10.0434,13.154722900390626L13.6906,13.154722900390626L13.6906,13.733722900390624C13.6906,14.101322900390626,13.9886,14.399322900390626,14.3562,14.399322900390626L19.3346,14.399322900390626C19.7022,14.399322900390626,20.0002,14.101322900390626,20.0002,13.733722900390624C20.0002,13.366222900390625,19.7022,13.068122900390625,19.3346,13.068122900390625L15.0218,13.068122900390625L15.0218,11.910122900390625L19.3346,11.910122900390625C19.7022,11.910122900390625,20.0002,11.612122900390625,20.0002,11.244522900390624C20.0002,10.876922900390625,19.7022,10.578922900390625,19.3346,10.578922900390625L14.3562,10.578922900390625C13.9887,10.578922900390625,13.6906,10.876922900390625,13.6906,11.244522900390624L13.6906,11.823522900390625L9.37785,11.823522900390625C9.0103,11.823522900390625,8.71226,12.121522900390625,8.71226,12.489122900390624L8.71226,14.312722900390625L5.06485,14.312722900390625L5.06485,5.687202900390625L8.71219,5.687202900390625L8.71219,7.510772900390625C8.71219,7.878312900390625,9.01017,8.176362900390625,9.37778,8.176362900390625L13.6906,8.176362900390625L13.6906,8.755422900390625C13.6906,9.122962900390625,13.9886,9.421012900390625,14.3562,9.421012900390625L19.3345,9.421012900390625C19.7021,9.421012900390625,20.0001,9.123032900390625,20.0001,8.755422900390625C20.0001,8.387882900390625,19.7022,8.089832900390626,19.3345,8.089832900390626L15.0218,8.089832900390626L15.0218,6.931782900390625L19.3345,6.931782900390625C19.7021,6.931782900390625,20.0001,6.633802900390625,20.0001,6.266192900390625C20.0001,5.898652900390625,19.7022,5.600602900390625,19.3345,5.600602900390625L14.3562,5.600602900390625C13.9886,5.600602900390625,13.6906,5.898582900390625,13.6906,6.266192900390625L13.6906,6.845182900390625L10.0433,6.845182900390625L10.0433,3.197982900390625L13.6906,3.197982900390625L13.6906,3.777032900390625C13.6905,4.144582900390625,13.9886,4.442622900390624,14.3561,4.442622900390624Z"
                    fill-opacity="1"
                    :fill="isFile === 2 ? `#3D3D3D` : `#878E97`"
                />
              </g>
            </g>
          </g>
        </svg>
      </button>
      <button class="myButton" @click="isFile = 0">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" version="1.1"
             width="20" height="20" viewBox="0 0 20 20">
          <g clip-path="url(#master_svg0_71_426)">
          <g>
            <path d="M4.999994123535156,5.83333L4.999994123535156,3.333333C4.999994123535156,2.873096,5.373094123535156,2.5,5.833334123535156,2.5L11.178334123535157,2.5L12.844964123535156,4.16667L17.499964123535158,4.16667C17.960264123535158,4.16667,18.333364123535155,4.539759999999999,18.333364123535155,5L18.333364123535155,13.3333C18.333364123535155,13.7936,17.960264123535158,14.1667,17.499964123535158,14.1667L14.999964123535156,14.1667L14.999964123535156,16.6667C14.999964123535156,17.1269,14.626864123535157,17.5,14.166664123535156,17.5L2.4999971235351564,17.5C2.039760123535156,17.5,1.6666641235351562,17.1269,1.6666641235351562,16.6667L1.6666641235351562,6.66667C1.6666641235351562,6.20643,2.039760123535156,5.83333,2.4999971235351564,5.83333L4.999994123535156,5.83333ZM4.999994123535156,7.5L3.333334123535156,7.5L3.333334123535156,15.8333L13.333364123535157,15.8333L13.333364123535157,14.1667L4.999994123535156,14.1667L4.999994123535156,7.5Z"
                  :fill="isFile === 0 ? `#3D3D3D` : `#878E97`"
                  fill-opacity="1"/>
          </g>
          </g>
        </svg>
      </button>
      <button class="myButton" @click="isFile = 1" v-if="false">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" version="1.1"
             width="20" height="20" viewBox="0 0 20 20">
          <g clip-path="url(#master_svg0_71_1317)">
            <g>
              <path
                  d="M15.025867938232421,13.847467938232422L18.594967938232422,17.415867938232424L17.415867938232424,18.594967938232422L13.847467938232422,15.025867938232421C12.519767938232421,16.090167938232423,10.868337938232422,16.669067938232423,9.166667938232422,16.666667938232422C5.026667938232421,16.666667938232422,1.6666679382324219,13.306667938232422,1.6666679382324219,9.166667938232422C1.6666679382324219,5.026667938232421,5.026667938232421,1.6666679382324219,9.166667938232422,1.6666679382324219C13.306667938232422,1.6666679382324219,16.666667938232422,5.026667938232421,16.666667938232422,9.166667938232422C16.669067938232423,10.868337938232422,16.090167938232423,12.519767938232421,15.025867938232421,13.847467938232422ZM13.882467938232422,7.499997938232422C13.175967938232422,5.501647938232422,11.286237938232421,4.165907938232422,9.166667938232422,4.166667938232422C6.404167938232422,4.166667938232422,4.166667938232422,6.404167938232422,4.166667938232422,9.166667938232422L5.833337938232422,9.166667938232422C5.834097938232422,6.639167938232422,8.537087938232421,5.031547938232421,10.758337938232422,6.237497938232422L9.999997938232422,7.499997938232422L13.882467938232422,7.499997938232422ZM14.166667938232422,9.166667938232422L12.499967938232421,9.166667938232422C12.499267938232421,11.694167938232422,9.796247938232423,13.301767938232421,7.574997938232422,12.095867938232422L8.333337938232422,10.833337938232422L4.4508379382324215,10.833337938232422C5.157357938232422,12.831667938232421,7.0470979382324215,14.167467938232422,9.166667938232422,14.166667938232422C11.929167938232421,14.166667938232422,14.166667938232422,11.929167938232421,14.166667938232422,9.166667938232422Z"
                  :fill="isFile === 1 ? `#3D3D3D` : `#878E97`"
                  fill-opacity="1"/>
            </g>
          </g>
        </svg>
      </button>
      <button class="myButton" @click="getRelation">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" version="1.1"
             width="20" height="20" viewBox="0 0 20 20">
          <g>
            <g>
              <path
                  d="M2.5,3.125L17.5,3.125C18.1901,3.12568903,18.7493,3.68493,18.75,4.375L18.75,15.625C18.7493,16.3151,18.1901,16.874299999999998,17.5,16.875L9.375,16.875L9.375,4.375L2.5,4.375L2.5,10.625L1.25,10.625L1.25,4.375C1.250688881,3.68493,1.80993,3.12568903,2.5,3.125ZM10.625,4.375L10.625,15.625L17.5009,15.625L17.5,4.375L10.625,4.375ZM16.25,6.25L11.875,6.25L11.875,7.5L16.25,7.5L16.25,6.25ZM16.25,9.375L11.875,9.375L11.875,10.625L16.25,10.625L16.25,9.375ZM2.5,13.75L2.5,12.5L6.875,12.5L6.875,16.875L5.625,16.875L5.625,14.6337L2.13375,18.125L1.25,17.241300000000003L4.74125,13.75L2.5,13.75ZM16.25,12.5L11.875,12.5L11.875,13.75L16.25,13.75L16.25,12.5Z"
                  fill-rule="evenodd"
                  :fill="isFile === 3 ? `#3D3D3D` : `#878E97`"
                  fill-opacity="1"/>
            </g>
            <g></g>
          </g>
        </svg>
      </button>
      <button class="myButton" @click="isFile = 4; getTags">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" version="1.1"
             width="20" height="20" viewBox="0 0 20 20">
          <g>
            <g>
              <g>
                <path
                    d="M3.18739,4.51913C1.28391,5.60391,0,7.65174,0,10L0,13.4783L1.73913,13.4783L1.73913,10L3.69565,10L3.69565,15.2174L5.43478,15.2174L5.43478,10L7.39131,10L7.39131,16.9565C7.39131,17.6757,6.80618,18.2609,6.08696,18.2609L3.04348,18.2609L3.04348,20L6.08696,20C7.76513,20,9.13044,18.6347,9.13044,16.9565L9.13044,20L10.8696,20L10.8696,16.96C10.8714,18.6366,12.236,20,13.913,20L16.9565,20L16.9565,18.2609L13.913,18.2609C13.1938,18.2609,12.6087,17.6757,12.6087,16.9565L12.6087,10L14.5652,10L14.5652,15.2174L16.3043,15.2174L16.3043,10L18.2609,10L18.2609,13.4783L20,13.4783L20,10C20,7.65174,18.7161,5.60391,16.8126,4.51913C15.6913,1.86348,13.0635,0,10,0C6.93652,0,4.3087,1.86348,3.18739,4.51913Z"
                    fill-rule="evenodd"
                    :fill="isFile === 4 ? `#3D3D3D` : `#878E97`"
                    fill-opacity="1"/>
              </g>
            </g>
          </g>
        </svg>
      </button>
      <button class="myButton" @click="isFile = 5" v-if="false">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" version="1.1"
             width="20" height="20" viewBox="0 0 20 20">
          <g clip-path="url(#master_svg0_71_462)">
            <g>
              <g>
                <path
                    d="M5.4884881469726565,0.21179667150683593C7.229938146972656,0.23812464450683593,8.658878146972656,1.6542962445068359,8.699938146972656,3.395476244506836C8.709938146972656,3.821416244506836,8.638378146972656,4.229346244506836,8.499668146972656,4.604696244506836C8.374198146972656,4.944346244506836,8.369978146972656,5.308326244506836,8.470528146972656,5.641296244506836L5.142738146972656,11.631316244506836L6.653328146972656,11.631316244506836L5.854428146972657,13.069416244506836L4.383448146972656,11.598416244506836L3.2298481469726563,12.752016244506835L4.622348146972656,14.144516244506836L4.622348146972656,15.287216244506835L4.303918146972657,15.860516244506837C1.8951581469726562,15.344016244506836,0.06023304697265625,13.219416244506835,0.00152200697265625,10.672216244506837C-0.03797015302734375,8.960686244506835,0.7136331469726562,7.423646244506836,1.9160981469726563,6.400596244506836C2.435828146972656,5.958446244506836,2.6065281469726562,5.234736244506836,2.3723481469726564,4.593756244506836C2.244808146972656,4.244616244506836,2.1751981469726562,3.867546244506836,2.1751981469726562,3.4742662445068357C2.1751981469726562,1.6554762445068358,3.6633681469726564,0.18425734450683595,5.4884881469726565,0.21179667150683593ZM16.676738146972657,9.999986244506836L20.000038146972656,15.981916244506836L6.102668146972657,15.981916244506836L9.425918146972656,9.999986244506836L7.915368146972656,9.999986244506836L13.051338146972656,0.7552392445068359L18.187238146972657,9.999986244506836L16.676738146972657,9.999986244506836ZM6.253728146972656,17.613316244506837L4.622318146972656,17.613316244506837L4.622318146972656,19.788516244506837L6.253728146972656,19.788516244506837L6.253728146972656,17.613316244506837ZM13.867038146972657,17.613316244506837L12.235638146972656,17.613316244506837L12.235638146972656,19.788516244506837L13.867038146972657,19.788516244506837L13.867038146972657,17.613316244506837Z"
                    fill-rule="evenodd"
                    :fill="isFile === 5 ? `#3D3D3D` : `#878E97`"
                    fill-opacity="1"/>
              </g>
            </g>
          </g>
        </svg>
      </button>
      <button class="myButton" @click="getGraph">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" version="1.1"
             width="20" height="20" viewBox="0 0 20 20">
          <g clip-path="url(#master_svg0_71_487)">
            <g>
              <g>
                <g>
                  <path
                      d="M13.1875,8.05C12.8791,7.53752,12.45,7.10835,11.9375,6.8C10.7456,6.0503,9.22941,6.0503,8.0375,6.8C7.52502,7.10835,7.09585,7.53752,6.7875,8.05C6.4331,8.6385,6.24717,9.31304,6.25,10C6.2377,10.1623,6.2377,10.3252,6.25,10.4875C6.54874,12.2985,8.11449,13.6272,9.95,13.6272C11.7855,13.6272,13.3513,12.2985,13.65,10.4875C13.6958,10.3278,13.7293,10.1648,13.75,10C13.7453,9.31065,13.5507,8.63594,13.1875,8.05ZM7.15,5.9125L3.6625,2.425C3.71686,2.24657,3.7463,2.06149,3.75,1.875C3.75,0.839466,2.91053,0,1.875,0C0.839466,0,0,0.839466,0,1.875C0,2.91053,0.839466,3.75,1.875,3.75C2.06149,3.7463,2.24657,3.71686,2.425,3.6625L5.9125,7.15C6.23979,6.66028,6.66028,6.23979,7.15,5.9125ZM3.1,11.7125C2.76231,11.4131,2.32627,11.2485,1.875,11.25C0.870488,11.2573,0.0501605,12.0549,0.0147221,13.0588C-0.0207163,14.0627,0.741326,14.9162,1.74283,14.9943C2.74433,15.0724,3.62943,14.3473,3.75,13.35L5.7625,12.575C5.45636,12.0749,5.24057,11.5249,5.125,10.95L3.1,11.7125ZM16.875,5C17.9105,5,18.75,4.16053,18.75,3.125C18.75,2.08947,17.9105,1.25,16.875,1.25C15.8395,1.25,15,2.08947,15,3.125C15.0037,3.31149,15.0331,3.49657,15.0875,3.675L12.85,5.9125C13.3454,6.24217,13.7703,6.66707,14.1,7.1625L16.3375,4.925C16.5125,4.974,16.6933,4.99923,16.875,5ZM10.875,16.475L10.875,14.9125C10.5864,14.967,10.2937,14.9963,10,15C9.70635,14.9963,9.41358,14.967,9.125,14.9125L9.125,16.475C8.07682,17.0281,7.79827,18.4027,8.54848,19.3202C9.29869,20.2377,10.7013,20.2377,11.4515,19.3202C12.2017,18.4027,11.9232,17.0281,10.875,16.475ZM18.125,11.25C17.6651,11.2423,17.2191,11.4073,16.875,11.7125L14.875,10.95C14.7625,11.5258,14.5465,12.0763,14.2375,12.575L16.25,13.35C16.3706,14.3473,17.2557,15.0724,18.2572,14.9943C19.2587,14.9162,20.0207,14.0627,19.9853,13.0588C19.9498,12.0549,19.1295,11.2573,18.125,11.25Z"
                      :fill="isFile === 6 ? `#3D3D3D` : `#878E97`"
                      fill-opacity="1"/>
                </g>
              </g>
            </g>
          </g>
        </svg>
      </button>
    </div>
    <div>
      <div class="header items-center content-center" style="z-index: 10">
        <div class="manage items-center content-center" style="display: flex">
          <text class="myText pl-2">
            {{ textWords }}
          </text>
          <button class="header1-button" @click="handleFlush">
            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" version="1.1"
                 width="15" height="18" viewBox="0 0 9.848484992980957 10">
              <defs>
                <clipPath id="master_svg0_71_2057">
                  <rect x="0" y="0" width="9.848484992980957" height="10" rx="0"/>
                </clipPath>
              </defs>
              <g clip-path="url(#master_svg0_71_2057)">
                <g>
                  <path
                      d="M4.924249228515625,9.166663015441895C2.6578592285156253,9.166663015441895,0.820709228515625,7.301253015441895,0.820709228515625,5.000003015441894C0.820709228515625,2.698753015441895,2.6578592285156253,0.8333330154418945,4.924249228515625,0.8333330154418945C7.190629228515625,0.8333330154418945,9.027779228515625,2.698753015441895,9.027779228515625,5.000003015441894C9.027779228515625,7.301253015441895,7.190629228515625,9.166663015441895,4.924249228515625,9.166663015441895ZM6.902149228515625,7.115003015441895C7.925329228515625,6.130283015441894,8.093509228515625,4.537173015441894,7.299139228515625,3.3546230154418946C6.504769228515625,2.1720730154418946,4.982639228515625,1.7496380154418945,3.706319228515625,2.3575030154418943L4.106409228515625,3.0887530154418945C5.461679228515625,2.4906630154418945,6.976419228515625,3.4995230154418944,6.976009228515625,5.000003015441894L5.744949228515625,5.000003015441894L6.902149228515625,7.115003015441895ZM6.142169228515625,7.6425030154418945L5.742079228515625,6.911253015441894C4.3868092285156255,7.509343015441894,2.872069228515625,6.500473015441894,2.872479228515625,5.000003015441894L4.103539228515626,5.000003015441894L2.946339228515625,2.8850030154418946C1.923169228515625,3.8697130154418944,1.754976228515625,5.462823015441894,2.549349228515625,6.645373015441894C3.343719228515625,7.827923015441894,4.865849228515625,8.250363015441895,6.142169228515625,7.6425030154418945Z"
                      fill="#474747" fill-opacity="1"/>
                </g>
              </g>
            </svg>
          </button>
          <button class="header2-button " v-if="isFile === 1 || isFile === 5 || isFile === 6">
            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" version="1.1" width="18" height="18" viewBox="0 0 10 10"><defs><clipPath id="master_svg0_71_1615"><rect x="0" y="0" width="10" height="10" rx="0"/></clipPath></defs><g clip-path="url(#master_svg0_71_1615)"><g><path d="M5.000005266113281,4.410833358764648L7.062505266113281,2.3483335574466486L7.651665266113281,2.937500358764648L5.589165266113281,5.000003358764649L7.651665266113281,7.062503358764649L7.062505266113281,7.651663358764648L5.000005266113281,5.589163358764648L2.937502266113281,7.651663358764648L2.3483354647952814,7.062503358764649L4.410835266113281,5.000003358764649L2.3483352661132812,2.937500358764648L2.937502266113281,2.3483333587646484L5.000005266113281,4.410833358764648Z" fill="#474747" fill-opacity="1"/></g></g></svg>
          </button>
          <button class="header2-button " v-if="isFile === 0" @click="handleNew('file')">
            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" version="1.1" width="18" height="18" viewBox="0 0 10 10"><defs><clipPath id="master_svg0_71_2060"><rect x="0" y="0" width="10" height="10" rx="0"/></clipPath></defs><g style="mix-blend-mode:passthrough" clip-path="url(#master_svg0_71_2060)"><g style="mix-blend-mode:passthrough"><path d="M1.616117,0.7827830308837891C1.850537,0.5483620308837891,2.168479,0.41666603088378906,2.5,0.41666603088378906C2.5,0.41666603088378906,5.83333,0.41666603088378906,5.83333,0.41666603088378906C5.94383,0.41666603088378906,6.04983,0.4605648308837891,6.12796,0.5387050308837891C6.12796,0.5387050308837891,8.62796,3.038706030883789,8.62796,3.038706030883789C8.70608,3.116846030883789,8.75,3.2228260308837893,8.75,3.333336030883789C8.75,3.333336030883789,8.75,8.333336030883789,8.75,8.333336030883789C8.75,8.66487603088379,8.61829,8.982796030883788,8.38387,9.217206030883789C8.149460000000001,9.451626030883789,7.83154,9.583336030883789,7.5,9.583336030883789C7.5,9.583336030883789,2.5,9.583336030883789,2.5,9.583336030883789C2.168479,9.583336030883789,1.850537,9.451626030883789,1.616117,9.217206030883789C1.381696,8.982796030883788,1.25,8.66487603088379,1.25,8.333336030883789C1.25,8.333336030883789,1.25,1.666666030883789,1.25,1.666666030883789C1.25,1.335145030883789,1.381696,1.017204030883789,1.616117,0.7827830308837891C1.616117,0.7827830308837891,1.616117,0.7827830308837891,1.616117,0.7827830308837891ZM2.5,1.2499990308837892C2.38949,1.2499990308837892,2.2835099999999997,1.293899030883789,2.205371,1.372037030883789C2.127233,1.450176030883789,2.083333,1.556156030883789,2.083333,1.666666030883789C2.083333,1.666666030883789,2.083333,8.333336030883789,2.083333,8.333336030883789C2.083333,8.443836030883789,2.127233,8.549836030883789,2.205371,8.627956030883789C2.2835099999999997,8.706086030883789,2.38949,8.74999603088379,2.5,8.74999603088379C2.5,8.74999603088379,7.5,8.74999603088379,7.5,8.74999603088379C7.6105,8.74999603088379,7.7165,8.706086030883789,7.79462,8.627956030883789C7.87275,8.549836030883789,7.91667,8.443836030883789,7.91667,8.333336030883789C7.91667,8.333336030883789,7.91667,3.749996030883789,7.91667,3.749996030883789C7.91667,3.749996030883789,5.83333,3.749996030883789,5.83333,3.749996030883789C5.60321,3.749996030883789,5.41667,3.563446030883789,5.41667,3.333336030883789C5.41667,3.333336030883789,5.41667,1.2499990308837892,5.41667,1.2499990308837892C5.41667,1.2499990308837892,2.5,1.2499990308837892,2.5,1.2499990308837892C2.5,1.2499990308837892,2.5,1.2499990308837892,2.5,1.2499990308837892ZM6.25,1.839256030883789C6.25,1.839256030883789,7.32742,2.916666030883789,7.32742,2.916666030883789C7.32742,2.916666030883789,6.25,2.916666030883789,6.25,2.916666030883789C6.25,2.916666030883789,6.25,1.839256030883789,6.25,1.839256030883789C6.25,1.839256030883789,6.25,1.839256030883789,6.25,1.839256030883789ZM5,4.583336030883789C5.230119999999999,4.583336030883789,5.41667,4.769876030883789,5.41667,4.999996030883789C5.41667,4.999996030883789,5.41667,5.833336030883789,5.41667,5.833336030883789C5.41667,5.833336030883789,6.25,5.833336030883789,6.25,5.833336030883789C6.48012,5.833336030883789,6.66667,6.019876030883789,6.66667,6.249996030883789C6.66667,6.480126030883789,6.48012,6.666666030883789,6.25,6.666666030883789C6.25,6.666666030883789,5.41667,6.666666030883789,5.41667,6.666666030883789C5.41667,6.666666030883789,5.41667,7.499996030883789,5.41667,7.499996030883789C5.41667,7.730126030883789,5.230119999999999,7.916666030883789,5,7.916666030883789C4.769880000000001,7.916666030883789,4.58333,7.730126030883789,4.58333,7.499996030883789C4.58333,7.499996030883789,4.58333,6.666666030883789,4.58333,6.666666030883789C4.58333,6.666666030883789,3.75,6.666666030883789,3.75,6.666666030883789C3.51988,6.666666030883789,3.33333,6.480126030883789,3.33333,6.249996030883789C3.33333,6.019876030883789,3.51988,5.833336030883789,3.75,5.833336030883789C3.75,5.833336030883789,4.58333,5.833336030883789,4.58333,5.833336030883789C4.58333,5.833336030883789,4.58333,4.999996030883789,4.58333,4.999996030883789C4.58333,4.769876030883789,4.769880000000001,4.583336030883789,5,4.583336030883789C5,4.583336030883789,5,4.583336030883789,5,4.583336030883789Z" fill-rule="evenodd" fill="#474747" fill-opacity="1"/></g></g></svg>
          </button>
          <button class="header3-button " v-if="isFile === 0" @click="handleNew('folder')">
            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" version="1.1" width="18" height="18" viewBox="0 0 10 10"><defs><clipPath id="master_svg0_71_2059"><rect x="0" y="0" width="10" height="10" rx="0"/></clipPath></defs><g style="mix-blend-mode:passthrough" clip-path="url(#master_svg0_71_2059)"><g style="mix-blend-mode:passthrough"><path d="M1.6666717529296875,1.666666969116211C1.5561617529296874,1.666666969116211,1.4501817529296874,1.7105669691162109,1.3720427529296875,1.788704969116211C1.2939047529296874,1.8668439691162109,1.2500047529296876,1.9728239691162108,1.2500047529296876,2.083333969116211C1.2500047529296876,2.083333969116211,1.2500047529296876,7.916663969116211,1.2500047529296876,7.916663969116211C1.2500047529296876,8.027163969116211,1.2939047529296874,8.133163969116211,1.3720427529296875,8.21129396911621C1.4501817529296874,8.289413969116211,1.5561617529296874,8.333333969116211,1.6666717529296875,8.333333969116211C1.6666717529296875,8.333333969116211,8.333341752929687,8.333333969116211,8.333341752929687,8.333333969116211C8.443841752929687,8.333333969116211,8.549841752929687,8.289413969116211,8.627961752929687,8.21129396911621C8.706091752929687,8.133163969116211,8.750001752929688,8.027163969116211,8.750001752929688,7.916663969116211C8.750001752929688,7.916663969116211,8.750001752929688,3.333333969116211,8.750001752929688,3.333333969116211C8.750001752929688,3.222823969116211,8.706091752929687,3.116843969116211,8.627961752929687,3.0387039691162108C8.549841752929687,2.960563969116211,8.443841752929687,2.916663969116211,8.333341752929687,2.916663969116211C8.333341752929687,2.916663969116211,4.583341752929687,2.916663969116211,4.583341752929687,2.916663969116211C4.444021752929688,2.916663969116211,4.313931752929688,2.847043969116211,4.236651752929688,2.731123969116211C4.236651752929688,2.731123969116211,3.5270117529296874,1.666666969116211,3.5270117529296874,1.666666969116211C3.5270117529296874,1.666666969116211,1.6666717529296875,1.666666969116211,1.6666717529296875,1.666666969116211C1.6666717529296875,1.666666969116211,1.6666717529296875,1.666666969116211,1.6666717529296875,1.666666969116211ZM0.7827887529296875,1.199450969116211C1.0172097529296875,0.965029969116211,1.3351507529296875,0.8333339691162109,1.6666717529296875,0.8333339691162109C1.6666717529296875,0.8333339691162109,3.7500017529296876,0.8333339691162109,3.7500017529296876,0.8333339691162109C3.8893217529296873,0.8333339691162109,4.019411752929687,0.902959369116211,4.096691752929687,1.018875969116211C4.096691752929687,1.018875969116211,4.806341752929687,2.083333969116211,4.806341752929687,2.083333969116211C4.806341752929687,2.083333969116211,8.333341752929687,2.083333969116211,8.333341752929687,2.083333969116211C8.664881752929688,2.083333969116211,8.982801752929687,2.215033969116211,9.217211752929687,2.449453969116211C9.451631752929687,2.683873969116211,9.583341752929687,3.001813969116211,9.583341752929687,3.333333969116211C9.583341752929687,3.333333969116211,9.583341752929687,7.916663969116211,9.583341752929687,7.916663969116211C9.583341752929687,8.248213969116211,9.451631752929687,8.56612396911621,9.217211752929687,8.80054396911621C8.982801752929687,9.03496396911621,8.664881752929688,9.166663969116211,8.333341752929687,9.166663969116211C8.333341752929687,9.166663969116211,1.6666717529296875,9.166663969116211,1.6666717529296875,9.166663969116211C1.3351507529296875,9.166663969116211,1.0172097529296875,9.03496396911621,0.7827887529296875,8.80054396911621C0.5483677529296875,8.56612396911621,0.4166717529296875,8.248213969116211,0.4166717529296875,7.916663969116211C0.4166717529296875,7.916663969116211,0.4166717529296875,2.083333969116211,0.4166717529296875,2.083333969116211C0.4166717529296875,1.751812969116211,0.5483677529296875,1.433871969116211,0.7827887529296875,1.199450969116211C0.7827887529296875,1.199450969116211,0.7827887529296875,1.199450969116211,0.7827887529296875,1.199450969116211ZM5.000001752929688,4.166663969116211C5.230131752929688,4.166663969116211,5.4166717529296875,4.3532139691162115,5.4166717529296875,4.583333969116211C5.4166717529296875,4.583333969116211,5.4166717529296875,5.416663969116211,5.4166717529296875,5.416663969116211C5.4166717529296875,5.416663969116211,6.250001752929688,5.416663969116211,6.250001752929688,5.416663969116211C6.480131752929688,5.416663969116211,6.6666717529296875,5.603213969116211,6.6666717529296875,5.833333969116211C6.6666717529296875,6.063463969116211,6.480131752929688,6.250003969116211,6.250001752929688,6.250003969116211C6.250001752929688,6.250003969116211,5.4166717529296875,6.250003969116211,5.4166717529296875,6.250003969116211C5.4166717529296875,6.250003969116211,5.4166717529296875,7.083333969116211,5.4166717529296875,7.083333969116211C5.4166717529296875,7.313463969116211,5.230131752929688,7.500003969116211,5.000001752929688,7.500003969116211C4.769881752929687,7.500003969116211,4.583341752929687,7.313463969116211,4.583341752929687,7.083333969116211C4.583341752929687,7.083333969116211,4.583341752929687,6.250003969116211,4.583341752929687,6.250003969116211C4.583341752929687,6.250003969116211,3.7500017529296876,6.250003969116211,3.7500017529296876,6.250003969116211C3.5198917529296874,6.250003969116211,3.3333417529296874,6.063463969116211,3.3333417529296874,5.833333969116211C3.3333417529296874,5.603213969116211,3.5198917529296874,5.416663969116211,3.7500017529296876,5.416663969116211C3.7500017529296876,5.416663969116211,4.583341752929687,5.416663969116211,4.583341752929687,5.416663969116211C4.583341752929687,5.416663969116211,4.583341752929687,4.583333969116211,4.583341752929687,4.583333969116211C4.583341752929687,4.3532139691162115,4.769881752929687,4.166663969116211,5.000001752929688,4.166663969116211C5.000001752929688,4.166663969116211,5.000001752929688,4.166663969116211,5.000001752929688,4.166663969116211Z" fill-rule="evenodd" fill="#474747" fill-opacity="1"/></g></g></svg>
          </button>
        </div>
      </div>
      <div class="content pt-2" v-contextmenu:contextmenu @contextmenu="handleRightClick($event)">
        <FileNav :navItems="data" v-if="isFile === 0" :selected="selected"></FileNav>
        <SearchBar v-if="isFile === 1"></SearchBar>
        <OutLine :items="titles" v-if="isFile === 2"></OutLine>
        <TagBar v-if="isFile === 3"></TagBar>
        <PropBar v-if="isFile === 4"></PropBar>
        <ForestBar v-if="isFile === 5"></ForestBar>
        <GraphBar v-if="isFile === 6"></GraphBar>
      </div>
    </div>
  </div>
  <v-contextmenu ref="contextmenu">
    <div v-if="data.length !== 0 && isFile === 0">
      <v-contextmenu-item class="hover:bg-gray-200 text-gray-700"  @click="handleNew('file')">新建文件</v-contextmenu-item>
      <v-contextmenu-item class="hover:bg-gray-200 text-gray-700"  @click="handleNew('folder')">新建文件夹</v-contextmenu-item>
      <v-contextmenu-item class="hover:bg-gray-200 text-gray-700"  @click="handlePaste">粘贴</v-contextmenu-item>
      <v-contextmenu-item class="hover:bg-gray-200 text-gray-700"  @click="handleCloseWorkArea">关闭工作区</v-contextmenu-item>
    </div>
<!--    <div v-if="isFile === 2">-->
<!--      <v-contextmenu-item class="hover:bg-gray-200 text-gray-700"  >新建段落</v-contextmenu-item>-->
<!--      <v-contextmenu-item class="hover:bg-gray-200 text-gray-700"  >高亮当前标题</v-contextmenu-item>-->
<!--      <v-contextmenu-item class="hover:bg-gray-200 text-gray-700"  >折叠所有章节</v-contextmenu-item>-->
<!--      <v-contextmenu-item class="hover:bg-gray-200 text-gray-700"  >折叠所有章节</v-contextmenu-item>-->
<!--      <v-contextmenu-item class="hover:bg-gray-200 text-gray-700"  >查找</v-contextmenu-item>-->
<!--    </div>-->
  </v-contextmenu>

</template>

<script>

import FileNav from '@/renderer/components/sideBar/FileNav'
import OutLine from '@/renderer/components/sideBar/OutLine'
import { computed, getCurrentInstance, ref, watch } from 'vue'
import { directive, Contextmenu, ContextmenuItem } from 'v-contextmenu'
import 'v-contextmenu/dist/themes/default.css'
import bus from 'vue3-eventbus'
import { useStore } from 'vuex'
import SearchBar from '@/renderer/components/sideBar/SearchBar'
import TagBar from '@/renderer/components/sideBar/RelationBar'
import PropBar from '@/renderer/components/sideBar/PropBar'
import ForestBar from '@/renderer/components/sideBar/ForestBar'
import GraphBar from '@/renderer/components/sideBar/GraphBar'

export default {
  name: 'SideBar',
  directives: {
    contextmenu: directive
  },
  components: {
    GraphBar,
    ForestBar,
    PropBar,
    TagBar,
    SearchBar,
    OutLine,
    FileNav,
    [Contextmenu.name]: Contextmenu,
    [ContextmenuItem.name]: ContextmenuItem
  },
  props: {
    data: {
      type: Array,
      required: true
    }
  },
  setup (props) {
    const isFile = ref(0)
    const titles = ref([]) // root的children
    const selected = ref([]) // 存储被选中的对象
    const copied = ref([]) // 存储被复制的对象路径
    const store = useStore()
    const TabXY = ref({ x: -1, y: -1 })
    // eslint-disable-next-line no-unused-vars
    const { proxy, ctx } = getCurrentInstance()
    const _this = ctx

    watch(() => store.state.xy, (newValue, oldValue) => {
      const temp = TabXY.value.x + '+' + TabXY.value.y
      if (store.getters.getXY !== temp) {
        _this.$refs.contextmenu.hide()
      }
    })

    const textWords = computed(() => {
      switch (isFile.value) {
        case 0:
          return '资源管理器'
        case 1:
          return '搜索与替换'
        case 2:
          return '文档大纲'
        case 3:
          return '引用与被引用'
        case 4:
          return '标签管理器'
        case 5:
          return '榕林'
        case 6:
          return '榕图'
        default:
          return '文档大纲'
      }
    })

    bus.on('addToSelected', (obj) => {
      selected.value.push(obj)
    })

    bus.on('newSelected', (obj) => {
      selected.value.length = 0
      selected.value.push(obj)
    })

    bus.on('deleteFromSelected', (index) => {
      selected.value.splice(index, 1)
    })

    function handleRightClick (e) {
      TabXY.value = { x: e.clientX, y: e.clientY }
      store.dispatch('updateXY', TabXY.value)
    }

    bus.on('openOutLine', (obj) => {
      titles.value = obj
    })

    bus.on('copyFileOrFolder', (obj) => {
      // 右键一个对象，如果对象已经在selectedList中，则不改变，如果不在，则新建一个selected
      let index = -1
      for (let i = 0; i < selected.value.length; i++) {
        if (obj.path === selected.value[i].path) {
          index = i
          break
        }
      }
      if (index === -1) {
        selected.value.length = 0
        selected.value.push(obj)
      }
      copied.value.length = 0
      for (let i = 0; i < selected.value.length; i++) {
        copied.value.push(selected.value[i].path)
      }
      console.log('copy: ', copied.value[0])
    })

    function handleNew (type) {
      if (props.data.length !== 0) {
        bus.emit('showDialogForNewFile', { type, father: props.data[0] })
      }
    }
    function getTags () {
      isFile.value = 4
      bus.emit('changeToTag')
    }

    function getGraph () {
      isFile.value = 6
      bus.emit('changeToGraph')
    }

    async function handleFlush () {
      if (props.data.length !== 0) {
        const projPath = props.data[0].path
        const newChildren = await window.electronAPI.refresh(projPath)
        const openDir = [{
          name: props.data[0].name,
          path: projPath,
          children: newChildren,
          curChild: -1,
          absolutePath: props.data[0].absolutePath,
          offset: -1,
          type: 'folder'
        }]
        bus.emit('openDir', openDir[0])
      }
      // selected.value.length = 0
    }

    async function handlePaste () {
      if (props.data.length !== 0) {
        const projPath = props.data[0].path
        await window.electronAPI.paste(copied.value[0], projPath, projPath)
        await handleFlush()
      }
    }

    bus.on('pasteForSpecialPath', async (path) => {
      if (props.data.length !== 0) {
        const projPath = props.data[0].path
        await window.electronAPI.paste(copied.value[0], path, projPath)
        await handleFlush()
      }
    })

    function handleCloseWorkArea () {
      selected.value.length = 0 // 清空选中区
      bus.emit('closeDir')
    }

    function getRelation () {
      isFile.value = 3
      bus.emit('changeToRelation')
    }

    return {
      isFile,
      titles,
      selected,
      textWords,
      handleRightClick,
      handleNew,
      handlePaste,
      getTags,
      getGraph,
      handleFlush,
      getRelation,
      handleCloseWorkArea
    }
  }
}
</script>

<style scoped>
.Sidebar {
  opacity: 1;
  background: #F4F4F3;
  width: 230px;
}

.toolsBar {
  /* ToolsBar */
  display: flex;
  flex-direction: column;
  position: absolute;
  left: 0px;
  top: 40px;
  width: 50px;
  height: 100%;
  opacity: 1;

  box-sizing: border-box;
  border-width: 0px 1px 0px 0px;
  border-style: solid;
  border-color: rgba(0, 0, 0, 0.1);

}

.header {
  /* Header */
  position: absolute;
  left: 60px;
  top: 45px;
  width: 160px;
  height: 25px;
  opacity: 1;
}

.content {
  /* Content */
  position: absolute;
  left: 60px;
  top: 70px;
  width: 160px;
  height: 100%;
  opacity: 1;
  /*border: 1px solid #D8D8D8;*/
}

.myButton {
  margin-top: 20px;
}

.myButton svg {
  width: 25px;
  height: 25px;
}

.myButton path {
  -webkit-transition: fill .3s;
  -webkit-transition:left .3s, fill .3s;
}

.myButton:hover path {
  fill: #42b983;
}

.myButton:active path {
  fill: #19734b;
}

.myButton:focus path {
  fill: #3D3D3D;
}

.myButton path {
  -webkit-transition: fill .3s;
  -webkit-transition:left .3s, fill .3s;
}

.myButton:hover path {
  fill: #42b983;
}

.myButton:active path {
  fill: #19734b;
}

.myButton:focus path {
  fill: #3D3D3D;
}

.myText {
  /* 文件资源管理器 */
  position: absolute;
  left: 0px;
  top: 1.5px;
  width: 100px;
  height: 20px;
  opacity: 1;

  font-family: "Noto Sans SC";
  font-size: 13px;
  font-weight: 400;
  letter-spacing: 0em;

  color: #3D3D3D;
}

.header1-button {
  position: absolute;
  top: 1px;
  right: 0;
}

.header1-button:hover path {
  fill: #42b983;
  fill-opacity: 1;
  -webkit-transition: fill .3s;
  -webkit-transition:left .3s, fill .3s;
}

.header1-button:active path {
  fill: #19734b;
  fill-opacity: 1;
  -webkit-transition: fill .3s;
  -webkit-transition:left .3s, fill .3s;
}

.header2-button {
  position: absolute;
  top: 1px;
  right: 25px;
}

.header2-button:hover path {
  fill: #42b983;
  fill-opacity: 1;
  -webkit-transition: fill .3s;
  -webkit-transition:left .3s, fill .3s;
}

.header2-button:active path {
  fill: #19734b;
  fill-opacity: 1;
  -webkit-transition: fill .3s;
  -webkit-transition:left .3s, fill .3s;
}

.header3-button {
  position: absolute;
  top: 1px;
  right: 50px;
}

.header3-button:hover path {
  fill: #42b983;
  fill-opacity: 1;
  -webkit-transition: fill .3s;
  -webkit-transition:left .3s, fill .3s;
}

.header3-button:active path {
  fill: #19734b;
  fill-opacity: 1;
  -webkit-transition: fill .3s;
  -webkit-transition:left .3s, fill .3s;
}

.manage {
  position: relative;
  left: 0px;
  top: 0px;
  height: 25px;
  opacity: 1;
}
</style>
